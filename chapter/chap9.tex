\chapter{ON THE INTERNAL STRUCTURE OF CITIES}

\section{The Model}

We consider a circular city of fixed radius $S$, located in a large economy. A single traded good is produced within the city, which is sold to the larger economy at a competitive price. Labor is supplied elastically at the reservation utility $\overline{u}$ that prevails in the larger economy. Workers have preferences over units of the produced good and the quantity of residential land that they consume. We would treat land as available at the boundary of the city at a price $q_f$, determined by its value in an agricultural use. We take the radius $S$ of the city as given.

The total land area of the city, $\pi S^2$, is divided between production use and residential use. We describe locations within the city by their pollar coordinates $(r, \phi)$, but for most purposes we consider only symmetric equilibria, where nothing depends on $\phi$, and refer simply to "location $r$". Let $\theta(r)$ be the fraction used for production. Let the employment density - employment per unit of production land - at location $r$ be $n(r)$, implying that total employment at $r$ is $2\pi r \theta(r) n(r)$. Let $N(r)$ be the number of workers housed at $r$, per unit of residential land. Then if each such person occupies $\ell(r)$ units of land, we have $\ell(r) N(r) = 1$.

Production technology involves: ordinary CRS that relates land, labor and the technology level to goods production. There is the external effect that relates technology level at any one location to the employment, weighted by distance, at other locations. Finally, there is a cost - in units of lost labor time - to commuting to and from work.

Production of the traded good at location $r$ is assumed to be a CRS of land, $2 \pi r \theta(r)$, and labor, $2\pi r \theta(r) n(r)$, at that location. Production per unit of land at location $r$ can thus be written as:

\begin{equation}
    x(r) = g(z(r))f(n(r))
\end{equation}

the functions $g$ and $f$ are taken to be CD:

\begin{equation}
    g(z) = z^{\gamma}
\end{equation}

and

\begin{equation}
    f(n) = An^{\alpha}
\end{equation}

The intercept term $g(z(r))$ is a productivity term that reflects an external effect on production at location $(r, 0)$ of employment at neighboring locations $(s, \phi)$. This production externality is assumed to be linear, and to decay exponentially at a rate $\delta$ with the distance between $(r, 0)$ and $(s, \phi)$:

\begin{equation*}
    z(r) = \delta \int_0^S \int_0^{2\pi} s\theta(s, \phi)n(s, \phi) e^{-\delta x(r, s, \phi)} d\phi ds,
\end{equation*}

where $x(r, s, \phi) = [r^2 - 2\cos(\phi)rs + s^2]^{1/2}$. Since allocations are assumed to be symmetric, we can write:

\begin{equation}
    z(r) = \int_0^S \psi(r, s)s \theta(s)n(s)ds,
\end{equation}

where

\begin{equation}
    \psi(r, s) = \delta \int_0^{2\pi} e^{-\delta x(r, s, \phi)}d\phi.
\end{equation}

Each worker is endowed with one unit of labor, which he supplies inelastically to the composite activity producing-and-commuting. The third aspect of the technology is a commuting cost that takes the form of a loss of labor time that depends on the distance traveled to and from work each day. Specifically, if a worker lives at location $s$ and works at location $r$, he delivers:

\begin{equation*}
    e^{-\kappa |r - s|}
\end{equation*}

hours of labor at location $r$.

Workers have identical preferences $U(c, \ell)$ over consumption of the produced good $c$ and residential land $\ell$. The function $U$ is CD:

\begin{equation}
    U(c, \ell) = c^{\beta}\ell^{1 - \beta}
\end{equation}

Let $c(r)$ and $\ell(r)$ denote the goods and land consumption of everyone housed at $r$. Every consumer-worker at every location must receive the reservation utility level:

\begin{equation}
    U(c(r), \ell(r)) = \overline{u}
\end{equation}

In this setting an allocation will mean a collection of functions $(z, \theta, n, N, c, \ell)$ on $[0, S]$ that describe productivity, land use, employment, and consumption at each location $r \in [0, S]$. To be feasible, an allocation must satisfy $\theta(r) \leq 1, N(r)\ell(r) = 1$. We need a test to determine whether any given triple $(\theta(r), n(r), N(r))$ of functions on $[0, S]$ describes an internally consistent pattern of land use, employement, and residential housing. Think of filling up the city, proceeding from the center, $r = 0$, outward to the edge, $r = S$. We define a state variable $H(r)$ with the interpretation as the stock of workers that remain unhoused at $r$, after employment and housing have been determined for locations $s \in [0, r)$. Let

\begin{equation}
    y(r) = 2\pi r[\theta(r)n(r) - (1 - \theta(r))N(r)]
\end{equation}

be the excess of people employed at location $r$ over people housed at $r$. Thus positive $y(r)$ values add to the stock $H(r)$ of unhoused workers and negative $y(r)$ values reduce $H(r)$. In addition, even if $y(r) = 0$, if the stock $H(r)$ is positive it will increase by the amount $\kappa H(r) \varepsilon$ over the interval $[r, r + \varepsilon)$ because housing is moved further away from employment: To bring $H(r)$ units of full time equivalent labor to $r$ requires that $e^{\kappa \varepsilon} H(r)$ units be brought to $r + \varepsilon$, provided we are bringing labor toward the center. Combining these two forces, we have that:

\begin{equation}
    \frac{dH(r)}{dr} = \begin{cases}
        y(r) - \kappa H(r) \text{ for } H(r) < 0 \\
        y(r) + \kappa H(r) \text{ for } H(r) > 0
    \end{cases}
\end{equation}

The opposite logic applies when $H(r) < 0$. In that case, there are people who are housed at locations $s < r$ who can be employed at locations $s \geq r$: These workers are traveling away from the center to get to work, so carrying the stock outward brings people farther from home on their way to work.

For an assignment of jobs and residences to be feasible, it must be the case that every worker be housed on $[0, S]$, or that:

\begin{equation}
    H(S) \leq 0
\end{equation}

The price of goods, set equal to one, and the utility level of workers, $\overline{u}$, are both determined by forces outside the city. It remains to determine the wage paid at location $r$ per unit of labor employed there, and the earnings received at $r$ per person housed at that location.

We will use the same notation, $w(r)$, to denote both the wage rate paid at location $r$ and the earnings of a worker housed at location $r$. If $r$ is a purely business location, $w(r)$ denotes the wage paid by firms operating there, and a worker who commutes to $r$ from $s$ has earnings $w(s) = e^{-\kappa |r - s|}w(r)$ available to spend at his place of residence. If $r$ is a purely residential location, then $(r)$ denotes the earnings of people who live there, and a resident at $r$ who works at $s$ must receive $w(s) = e^{\kappa |r - s|}w(r)$ per unit of labor supplied at $s$. Finally, if $r$ is a mixed-use location, people who live there also work there, and $w(r)$ denotes both the wage rate and net earnings at $r$.

let $q(r)$ be firm profit per unit of land at location $r$; let $Q(r)$ be the rent per unit of residential land at $r$. A firm located at $r$ chooses employment to maximize profit:

\begin{equation}
    q(r) = g(z(r))f(n(r)) - w(r)n(r) = \max_n \{g(z(r))f(n) - w(r)n\}.
\end{equation}

The maximized value is $q(r)$. Since the decision problem at location $r$ is completely determined by the technology level and wage rate at $r$, we can solve the first-order condition for the maximum problem to obtain $n = \hat{n}(w, z)$. The maximized value can be written as $q = \hat{q}(w, z)$. This is the budget bid rent, given $(w, z)$: the rent per unit of land that a firm would be willing to pay to opearate with these cost and productivity parameters.

\begin{equation*}
    \hat{n}(w, z) = (\frac{\alpha A z^{\gamma}}{w})^{1/(1 - \alpha)}
\end{equation*}

and

\begin{equation*}
    \hat{q}(w, z) = (1 - \alpha) (\frac{\alpha}{w})^{\alpha / (1 - \alpha)} A^{1 / (1 - \alpha)} z^{\gamma / (1 - \alpha)}
\end{equation*}

A consumer who lives at $r$ divides his earnings $w(r)$ over goods consumption $c$ and residential land $\ell$, at the prices $1$ and $Q(r)$. His earnings must be enough to yield him utility $\overline{u}$. Thus,

\begin{equation}
    w(r) = c(r) + Q(r)\ell(r) = \min_{c, \ell} [c + Q(r)\ell].
\end{equation}

subject to

\begin{equation*}
    U(c, \ell) \geq \overline{u}
\end{equation*}

The minimum values depend on $Q$ and $\overline{u}$. Suppressing the latter, we write them $\tilde{c}(Q)$ and $\tilde{\ell}(Q)$: Given these functions, we can solve:

\begin{equation*}
    w = \tilde{c}(Q) + Q\tilde{\ell}(Q)
\end{equation*}

for $Q = \hat{Q}(w)$, say, then define $\hat{c}(w) = \tilde{c}(Q(w))$ and $\hat{\ell}(w) = \tilde{\ell}(\hat{Q}(w))$. Since the market clearing condition for residential land is $N\ell = 1$, we also have $\hat{N}(w) \equiv 1/\hat{\ell}(w)$. Therefore,

\begin{equation*}
    \hat{N}(w) = \beta^{(\beta / (1 - \beta)}\overline{u}^{-1/(1 - \beta)}w^{\beta / (1 - \beta)}
\end{equation*}

and

\begin{equation*}
    \hat{Q}(w) = \beta^{\beta / (1 - \beta)} (1 - \beta) (\frac{w}{\overline{u}})^{1 / (1 - \beta)}
\end{equation*}

It will be assumed that land is allocated to its highest-value use. In context, this means that:

\begin{equation}
    \theta(r) > 0 \text{ implies } q(r) \geq Q(r)
\end{equation}

and

\begin{equation}
    \theta(r) < 1 \text{ implies } q(r) \leq Q(r)
\end{equation}

Finally, free mobility of labor implies a sharp restriction on equilibrium wages $w(r)$:

\begin{equation}
    e^{-\kappa |r - s|} w(s) \leq w(r) \leq e^{\kappa |r- s|} w(s) \text{ for all } s, r \in [0, S] \label{eq:equilibrium_wage_rates}
\end{equation}

This wage arbitrage condition says that no one can gain by changing his job location, incurring the loss in labor endowment that such a change may entail.

\begin{definition}
Let $\hat{n}(w, z)$ and $\hat{q}(w, z)$ be the employment and bid-rent functions defined by the firm's problem and let $\hat{N}(w)$ and $\hat{Q}(w)$ be the residential density and bid-rent functions defined by the household's problem. Then an equilibrium is a pair of piecewise continuous functions $\theta$ and $y$, and a collection $(z, n, N, w, q, Q, H)$ of continuous functions, all on $[0, S]$, such that for all $r$:

\begin{itemize}
\item $w(r)$ satisfies Equation \eqref{eq:equilibrium_wage_rates}.
\item $n(r) = \hat{n}(w(r), z(r))$ and $q(r) = \hat{q}(w(r), z(r))$.
\item $N(r) = \hat{N}(w(r))$ and $Q(r) = \hat{Q}(w(r))$.
\item $\theta(r), q(r)$ and $Q(r)$ satisfy $0 \leq \theta(r) \leq 1$;
\item $y(r), n(r), N(r), \theta(r)$ and $H(r)$ satisfy $H(0) = 0$ and;
\item $H(S) = 0$, and;
\item $z, \theta$ and $n$ satisfy the condition allocation of symmetry.
\end{itemize}
\end{definition}

\begin{assumption}
    (i) The functions $\hat{n}, \hat{q}: \mathbb{R}_+^2 \to \mathbb{R}_+$ and $\hat{N}, \hat{Q}: \mathbb{R}_+ \to \mathbb{R}_+$, are continuously differentiable. Both $\hat{n}$ and $\hat{q}$ are decreasing in $w$ and increasing in $z$; both $\hat{N}$ and $\hat{Q}$ are increasing in $w$. The first derivative $\hat{n}_z(w, z)$ satisfies (ii)

    \begin{equation*}
        \lim_{n \to \infty} \hat{n}_z(w, z) = 0,
    \end{equation*}

    for all $w > 0$. (iii) The function $U(c, \ell)$ is strictly increasing in $c$ and $\ell$.
\end{assumption}

\section{Equilibrium With Productivity Fixed}